{
  "hash": "f80cd8935210ec385def7c6b4ccba733",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Comparing Fama-French Three vs Five Factors\"\nauthor:\n  - name: Christoph Scheuch\n    url: https://christophscheuch.github.io/\n    affiliations:\n      - name: wikifolio Financial Technologies AG\ndate: \"2023-10-02\"\ndescription: An explanation for the difference in the size factors of Fama and French 3 and 5 factor data\nimage: thumbnail.png\nimage-alt: A 3D computer-rendered image of two stylized high rise office buildings, one small building and one large building, both buildings visible in the frame. Created with DALL-E 3.\ncategories: \n  - Data\n  - Replications\n  - R\n--- \n\n\nIn our book chapters [Replicating Fama and French Factors (R Version)](../../r/replicating-fama-and-french-factors) and [Replicating Fama and French Factors (Python Version)](../../python/replicating-fama-and-french-factors), we show how to construct factor portfolios that are fairly close to the popular data from [Prof. Kenneth French finance data library](https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html). In this blog post, I want to elaborate a bit more on the subtle difference between the size data in the Fama-French three (FF3)[^1] and five (FF5)[^2] factor data. \n\n## Analyzing monthly factor data\n\nI first start by downloading the monthly Fama-French factors using the `frenchdata` package. The currently available data ranges from July 1926 to August 2023. `1926-07-01` to `2023-08-01`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(frenchdata)\nlibrary(fixest)\n\nstart_date <- \"1926-07-01\"\nend_date <- \"2023-08-01\"\n\nfactors_ff3_monthly_raw <- download_french_data(\"Fama/French 3 Factors\")\nfactors_ff3_monthly <- factors_ff3_monthly_raw$subsets$data[[1]] |>\n  mutate(\n    month = floor_date(ymd(str_c(date, \"01\")), \"month\"),\n    across(c(RF, `Mkt-RF`, SMB, HML), ~as.numeric(.) / 100),\n    .keep = \"none\"\n  ) |>\n  rename_with(str_to_lower) |>\n  rename(mkt_excess = `mkt-rf`)\n\nfactors_ff5_monthly_raw <- download_french_data(\"Fama/French 5 Factors (2x3)\")\nfactors_ff5_monthly <- factors_ff5_monthly_raw$subsets$data[[1]] |>\n  mutate(\n    month = floor_date(ymd(str_c(date, \"01\")), \"month\"),\n    across(c(RF, `Mkt-RF`, SMB, HML, RMW, CMA), ~as.numeric(.) / 100),\n    .keep = \"none\"\n  ) |>\n  rename_with(str_to_lower) |>\n  rename(mkt_excess = `mkt-rf`) \n\nfactors_ff_monthly <- factors_ff3_monthly |> \n  rename_with(.cols = c(mkt_excess, rf, smb, hml),\n              ~str_c(.x, \"_ff3\")) |> \n  inner_join(\n    factors_ff5_monthly |> \n      select(month, mkt_excess, rf, smb, hml) |> \n      rename_with(.cols = c(mkt_excess, rf, smb, hml),\n              ~str_c(.x, \"_ff5\")), by = \"month\") |> \n  filter(month >= start_date & month <= end_date)\n\nindustries_ff_monthly_raw <- download_french_data(\"10 Industry Portfolios\")\nindustries_ff_monthly <- industries_ff_monthly_raw$subsets$data[[1]] |>\n  mutate(month = floor_date(ymd(str_c(date, \"01\")), \"month\")) |>\n  mutate(across(where(is.numeric), ~ . / 100)) |>\n  select(month, everything(), -date) |>\n  rename_with(str_to_lower)\n```\n:::\n\n\nLet us first inspect the summary statistics of each factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfactors_ff_monthly |> \n  pivot_longer(cols = - month) |> \n  select(name, value) |>\n  drop_na() |>\n  group_by(name) |>\n  summarize(\n    mean = mean(value),\n    sd = sd(value),\n    min = min(value),\n    q05 = quantile(value, 0.05),\n    q50 = quantile(value, 0.50),\n    q95 = quantile(value, 0.95),\n    max = max(value),\n    n = n()\n  ) |> \n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 9\n  name         mean      sd    min     q05    q50    q95    max     n\n  <chr>       <dbl>   <dbl>  <dbl>   <dbl>  <dbl>  <dbl>  <dbl> <int>\n1 hml_ff3   0.00284 0.0300  -0.139 -0.0413 0.0022 0.0541 0.128    721\n2 hml_ff5   0.00284 0.0300  -0.139 -0.0413 0.0022 0.0541 0.128    721\n3 mkt_exce… 0.00568 0.0449  -0.232 -0.0726 0.0092 0.0713 0.161    721\n4 mkt_exce… 0.00568 0.0449  -0.232 -0.0726 0.0092 0.0713 0.161    721\n5 rf_ff3    0.00362 0.00266  0      0      0.0038 0.0081 0.0135   721\n6 rf_ff5    0.00362 0.00266  0      0      0.0038 0.0081 0.0135   721\n7 smb_ff3   0.00186 0.0304  -0.172 -0.0421 0.0011 0.0501 0.214    721\n8 smb_ff5   0.00219 0.0302  -0.153 -0.0431 0.001  0.0481 0.183    721\n```\n\n\n:::\n:::\n\n\nThe above table shows that risk free rates `rf_*`, market excess returns `mkt_excess_*`, and value factors `hml_*` show de facto identical value across all statistics for FF3 and FF5. However, the size factors `smb_*`  seem to be different between the data sets. Another way to show the difference is running regressions, as we do in our replication chapters:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_smb <- lm(smb_ff3 ~ smb_ff5, data = factors_ff_monthly)\nsummary(model_smb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = smb_ff3 ~ smb_ff5, data = factors_ff_monthly)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.03543 -0.00192  0.00032  0.00205  0.03373 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.000303   0.000222   -1.36     0.17    \nsmb_ff5      0.987055   0.007338  134.51   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.00595 on 719 degrees of freedom\nMultiple R-squared:  0.962,\tAdjusted R-squared:  0.962 \nF-statistic: 1.81e+04 on 1 and 719 DF,  p-value: <2e-16\n```\n\n\n:::\n:::\n\n\nRegressing the FF3 size factor on its FF5 counterpart yields a coefficient of 0.99 and an R-squared around 96%, so definitely no perfect co-movement. \n\nIs this difference just an artifact in the data, limited to a certain time period? Figure @fig-1 shows that there are differences throughout the whole sample.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfactors_ff_monthly |> \n  mutate(difference = smb_ff3 - smb_ff5) |> \n  ggplot(aes(x = month, y = difference, fill = difference > 0)) +\n  geom_col() +\n  scale_x_date(date_breaks = \"10 years\", date_labels = \"%Y\") +\n  theme(legend.position = \"none\") + \n  labs(\n    x = NULL, y = \"smb_ff3 - smb_ff5\",\n    title = \"Difference between monthly size factors from FF3 and FF5 data\"\n  )\n```\n\n::: {.cell-output-display}\n![End-of-month difference between monthly size factors from Fama-French three (FF3) and five (FF5) factor data.](index_files/figure-html/fig-1-1.png){#fig-1 fig-alt='Title: Difference between monthly size factors from FF3 and FF5 data. The figure shows a bar chart  of end-of-month differences between monthly size factors Fama-French three (FF3) and five (FF5) data. The figure demonstrates that the differences exist throughout the full period from 1926 to 2023.' width=2100}\n:::\n:::\n\n\nWhere does this difference come from? In my opinion, there is one likelyexplanation for the differences: the size portfolios `portfolio_size` and value portfolios `portfolio_bm` are constructed as independent sorts in FF3, while `portfolio_bm`, `portfolio_op`, and `portfolio_inv` are the result of dependent sorts in FF5 (depending on `portfolio_size`). In FF5, `portfolio_size` is then calculated on averages based on `portfolio_bm`, `portfolio_op`, and `portfolio_inv` portfolios. As all portfolios are the result of value-weighted return aggregation, it is hence very likely that these aggregations lead to different values. \n\nThese subtle differences might even impact your statistical tests. As an example, let us consider one of the industry portfolios from `industry_ff_monthly`. We use the 'other' portfolio, which contains sectors such as mines, construction, entertainment, finance, etc. We run a gression of the corresponding industry portfolios against the market, size, and value factors of FF3 and FF5, respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindustry_returns <- industries_ff_monthly |> \n  select(month, ret_other = other) |> \n  inner_join(factors_ff_monthly, by = \"month\")\n\nmodel_ff3 <- feols(\n  ret_other ~ mkt_excess_ff3 + smb_ff3 + hml_ff3, \n  industry_returns\n)\n\nmodel_ff5 <- feols(\n  ret_other ~ mkt_excess_ff5 + smb_ff5 + hml_ff5, \n  industry_returns\n)\n\netable(model_ff3, model_ff5, coefstat = \"tstat\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        model_ff3         model_ff5\nDependent Var.:         ret_other         ret_other\n                                                   \nConstant         0.0017** (2.694)  0.0017** (2.689)\nmkt_excess_ff3   1.139*** (76.67)                  \nsmb_ff3           0.0500* (2.299)                  \nhml_ff3         0.3984*** (18.48)                  \nmkt_excess_ff5                     1.135*** (76.35)\nsmb_ff5                            0.0690** (3.196)\nhml_ff5                           0.3897*** (18.23)\n_______________ _________________ _________________\nVCOV type                     IID               IID\nObservations                  721               721\nR2                        0.89991           0.90059\nAdj. R2                   0.89949           0.90017\n---\nSignif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nThe results show that the size factor is only significant at the 5% level for the FF3 data, but it is significant at the 1% level for the FF5 version!\n\n## A quick look at daily factors\n\nLet us take a quick look at the daily factors to check whether the difference in size premia exists there as well. If my explanation for the difference is correct, then there should be differences. We can download the daily factor data in a similar fashion as the monthly data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfactors_ff3_daily_raw <- download_french_data(\"Fama/French 3 Factors [Daily]\")\nfactors_ff3_daily <- factors_ff3_daily_raw$subsets$data[[1]] |>\n  mutate(\n    date = ymd(date),\n    across(c(RF, `Mkt-RF`, SMB, HML), ~as.numeric(.) / 100),\n    .keep = \"none\"\n  ) |>\n  rename_with(str_to_lower) |>\n  rename(mkt_excess = `mkt-rf`)\n\nfactors_ff5_daily_raw <- download_french_data(\"Fama/French 5 Factors (2x3) [Daily]\")\nfactors_ff5_daily <- factors_ff5_daily_raw$subsets$data[[1]] |>\n  mutate(\n    date = ymd(date),\n    across(c(RF, `Mkt-RF`, SMB, HML, RMW, CMA), ~as.numeric(.) / 100),\n    .keep = \"none\"\n  ) |>\n  rename_with(str_to_lower) |>\n  rename(mkt_excess = `mkt-rf`) \n\nfactors_ff_daily <- factors_ff3_daily |> \n  rename_with(.cols = c(mkt_excess, rf, smb, hml),\n              ~str_c(.x, \"_ff3\")) |> \n  inner_join(\n    factors_ff5_daily |> \n      select(date, mkt_excess, rf, smb, hml) |> \n      rename_with(.cols = c(mkt_excess, rf, smb, hml),\n              ~str_c(.x, \"_ff5\")), by = \"date\")  |> \n  filter(date >= start_date & date <= end_date)\n\nmodel_smb <- lm(smb_ff3 ~ smb_ff5, data = factors_ff_daily)\nsummary(model_smb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = smb_ff3 ~ smb_ff5, data = factors_ff_daily)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.019389 -0.000393  0.000026  0.000419  0.013334 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1.50e-05   1.02e-05   -1.48     0.14    \nsmb_ff5      9.72e-01   1.88e-03  517.15   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.00125 on 15121 degrees of freedom\nMultiple R-squared:  0.946,\tAdjusted R-squared:  0.946 \nF-statistic: 2.67e+05 on 1 and 15121 DF,  p-value: <2e-16\n```\n\n\n:::\n:::\n\n\nRegressing the FF3 size factor on its FF5 counterpart yields a coefficient of 0.97 and an R-squared around 95%, so again no perfect co-movement. Unreported results of the distributions and differences over time confirm the regression results and are in line with differences among monthly factor data.\n\n## Conclusion\n\nAre there any implications for empirical applications? In my opinion, you should be careful when you want to test your portfolios against FF3 and FF5 factors. It is strictly speaking not correct to just use a subsample of factors from FF5 if you want to test against the FF3 factors. I rather recommend downloading both FF3 and FF5 and run tests with each data set separately. \n\n\n[^1]: Fama, E. F.; French, K. R. (1993). \"Common risk factors in the returns on stocks and bonds\". Journal of Financial Economics. 33: 3–56. [https://doi.org/10.1016/0304-405X(93)90023-5](https://doi.org/10.1016/0304-405X(93)90023-5)\n\n[^2]: Fama, E. F.; French, K. R. (2015). \"A Five-Factor Asset Pricing Model\". Journal of Financial Economics. 116: 1–22. CiteSeerX 10.1.1.645.3745. [https://doi.org/10.1016/j.jfineco.2014.10.010](https://doi.org/10.1016/j.jfineco.2014.10.010)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}